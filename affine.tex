\documentclass{article}[11pt]

\usepackage{amsmath,amsfonts}

\title{Distance Between Affine Subspaces}

\begin{document}

\maketitle

\section{Definitions for Affine Spaces}

The \emph{affine hull} of a finite set of vectors $S = \{ p_0, p_1, ... p_n \} \subseteq \mathbb{R}^d$ is the set,

\[ \text{aff}(S) = \left \{ \sum_{i=0}^n \alpha_i p_i : \sum_{i=0}^{n} \alpha_i = 1 \: \text{ and } \: \alpha_i \in \mathbb{R} \right \} . \]

Or equivalently:

\begin{equation}
\label{eqn:affinedef}
\text{aff}(S) = \left \{ p_0 + \sum_{i=1}^n \alpha_i (p_i - p_0) : \alpha_i \in \mathbb{R} \right \} .
\end{equation}

The set $\text{aff}(S) \subseteq \mathbb{R}^d$ is called an \emph{affine subspace} and the generating set $S$ is called an \emph{affine basis}.  A collection of vectors is called \emph{affinely independent} if removing any one of them shrinks their affine hull.  It is a fact that in $\mathbb{R}^d$ any affine subspace has a finite affinely independent basis, and one less than the cardinality of this set is called the \emph{dimension} of the affine subspace.

\section{Distance}

Ok, with that out of the way let's now get the problem at hand which is to calculate the distance between a pair of affine subspaces.  Let $L, M$ be a pair of affine subspaces which are generated by affinely independent bases $\{ p_0, p_1, ..., p_n \}$ and $\{ q_0, q_1, ..., q_m \}$ respectively.  Then the (squared) distance between $L$ and $M$ is defined to be:

\[ \min_{ x \in L, y \in M } | x - y |^2 \]

Which by Eqn.~\ref{eqn:affinedef} is the same as:

\[ \min_{ \alpha \in \mathbb{R}^n, \beta \in \mathbb{R}^m } | p_0 + \sum_{i=1}^n \alpha_i (p_i - p_0) - q_0 - \sum_{j=1}^m \beta_j (q_j - q_0) |^2 \]

Expanding the inner expression gives a quadratic polynomial in $\alpha_i, \beta_j$:

\begin{equation}
\label{eqn:messyquadratic}
(p_0 \cdot p_0 - 2 p_0 \cdot q_0 + q_0 \cdot q_0)
  - 2 \sum_{i=1}^n \alpha_i (p_i - p_0) \cdot q_0 
  - 2 \sum_{j=1}^n \beta_j (q_j - q_0) \cdot p_0 
  + \sum_{i=1}^n \sum_{j=1}^n \alpha_i \alpha_j (p_i - p_0) \cdot (p_j - p_0)
  - 2 \sum_{i=1}^n \sum_{j=1}^m \alpha_i \beta_j (p_i - p_0) \cdot (q_i - q_0)
   + \sum_{i=1}^m \sum_{j=1}^m \beta_i \beta_j (q_i - q_0) \cdot (q_j - q_0)
\end{equation}

To simplify the expression let us define the following matrices:

\[ P = \left [ \begin{array}{c}
(p_1 - p_0)^T \\
(p_2 - p_0)^T \\
... \\
(p_n - p_0)^T \\
\end{array} \right ] \]

\[ Q = \left [ \begin{array}{c}
(q_1 - q_0)^T \\
(q_2 - q_0)^T \\
... \\
(q_m - q_0)^T \\
\end{array} \right ] \]

Along with the following vectors:

\[ a = [ \alpha_1, \alpha_2, ..., \alpha_n ]^T \]
\[ b = [ \beta_1, \beta_2, ..., \beta_m ]^T \]

And so we can use this to simplify Eqn.~\ref{eqn:messyquadratic} to:

\[ \min_{a \in \mathbb{R}^n, b \in \mathbb{R}^m} |p_0 - q_0|^2 - 2 (a^T P p_0 + b^T Q q_0) + [ a^T \: b^T ] \left [ \begin{array}{cc}
P P^T & P Q^T \\
Q P^T & Q Q^T \\
\end{array} \right ] \left [ \begin{array}{c}
a \\
b \\
\end{array} \right ] \]

Since the quadratic term here is positive semidefinite, the minima of the equation is just the 0 level set of the gradient.  By elementary calculus can compute this directly by solving the following linear system in terms of $a$ and $b$:

\begin{equation}
\label{eqn:distance}
\left [ \begin{array}{cc}
P P^T & P Q^T \\
Q P^T & Q Q^T \\
\end{array} \right ]
\left [ \begin{array}{c}
a \\
b \\
\end{array} \right ] = 
\left [ \begin{array}{c}
P p_0 \\
Q q_0 \\
\end{array} \right ]
\end{equation}

Using the solution of Eqn.\ref{eqn:distance} we can calucate the distance by directly subsituting and find the closest pair of points $x \in L, y \in M$  using the rule:

\[ x = P^T a + p_0 \]
\[ y = Q^T b + q_0 \]

Positive semidefiniteness implies that there always exists a solution to the system but it may not be unique.  Degnerate solutions correspond to the situation where there may be more than one closest pair of points between the two sets (ie there is a closest subspace).  Similarly, this Eqn.~\ref{eqn:distance} can also be used to determine if a pair of affine subspaces intersect, since if they do the distance between them is 0.

\end{document}